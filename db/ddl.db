CREATE TABLE gender (
    gender_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE orientation (
    orientation_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE relationship_type (
    relationship_type_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE interest (
    interest_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE user (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    fullname VARCHAR(150) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    birthdate DATE NOT NULL,
    gender_id INT NOT NULL,
    orientation_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (gender_id) REFERENCES gender(gender_id),
    FOREIGN KEY (orientation_id) REFERENCES orientation(orientation_id)
);

CREATE TABLE user_interest (
    user_id INT NOT NULL,
    interest_id INT NOT NULL,
    PRIMARY KEY (user_id, interest_id),
    FOREIGN KEY (user_id) REFERENCES user(user_id),
    FOREIGN KEY (interest_id) REFERENCES interest(interest_id)
);


CREATE TABLE user_relationship_type (
    user_id INT NOT NULL,
    relationship_type_id INT NOT NULL,
    PRIMARY KEY (user_id, relationship_type_id),
    FOREIGN KEY (user_id) REFERENCES user(user_id),
    FOREIGN KEY (relationship_type_id) REFERENCES relationship_type(relationship_type_id)
);


CREATE TABLE user_like (
    like_id INT AUTO_INCREMENT PRIMARY KEY,
    liker_id INT NOT NULL,
    liked_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (liker_id) REFERENCES user(user_id),
    FOREIGN KEY (liked_id) REFERENCES user(user_id),
    CONSTRAINT unique_like UNIQUE (liker_id, liked_id)
);


CREATE TABLE match_table (
    match_id INT AUTO_INCREMENT PRIMARY KEY,
    user1_id INT NOT NULL,
    user2_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user1_id) REFERENCES user(user_id),
    FOREIGN KEY (user2_id) REFERENCES user(user_id),
    CONSTRAINT unique_match UNIQUE (user1_id, user2_id)
);

CREATE TABLE daily_likes (
    daily_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    like_count INT NOT NULL DEFAULT 0,
    record_date DATE NOT NULL,
    FOREIGN KEY (user_id) REFERENCES user(user_id),
    CONSTRAINT unique_daily UNIQUE (user_id, record_date)
);

CREATE TABLE statistics (
    stat_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    total_likes_sent INT DEFAULT 0,
    total_likes_received INT DEFAULT 0,
    total_matches INT DEFAULT 0,
    last_update TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user(user_id)
);